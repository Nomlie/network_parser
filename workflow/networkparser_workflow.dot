digraph NetworkParser {
    rankdir=LR;
    bgcolor="#F9FAFB";
    node [shape=rect, style="rounded,filled", fillcolor="#FFFFFF", fontname="Arial", fontsize=11, penwidth=2, color="#E0E0E0"];
    edge [color="#6B7280", penwidth=1.5, fontname="Arial", fontsize=10, arrowsize=0.8];

    subgraph cluster_input {
        label="1. Input Processing";
        color="#3B82F6";
        style=filled;
        fillcolor="#EFF6FF";
        labelfontname="Arial Bold";
        labelfontsize=12;
        labelfontcolor="#3B82F6";
        n1 [label="Genomic Data\n(CSV, VCF, FASTA)", fillcolor="#BFDBFE", fontcolor="#1E40AF"];
        n2 [label="Metadata\n(Phenotypes, Hierarchies)", fillcolor="#BFDBFE", fontcolor="#1E40AF"];
        n3 [label="Known Markers\n(Optional)", fillcolor="#BFDBFE", fontcolor="#1E40AF"];
    }

    subgraph cluster_pattern {
        label="2. Pattern Discovery";
        color="#22C55E";
        style=filled;
        fillcolor="#F0FDF4";
        labelfontname="Arial Bold";
        labelfontsize=12;
        labelfontcolor="#22C55E";
        n4 [label="Label-Aware\nDecision Tree Construction", fillcolor="#BBF7D0", fontcolor="#166534"];
        n5 [label="Epistatic Interaction\nDetection", fillcolor="#BBF7D0", fontcolor="#166534"];
    }

    subgraph cluster_validation {
        label="3. Statistical Validation";
        color="#F59E0B";
        style=filled;
        fillcolor="#FFF7ED";
        labelfontname="Arial Bold";
        labelfontsize=12;
        labelfontcolor="#F59E0B";
        n6 [label="Bootstrap Resampling", fillcolor="#FED7AA", fontcolor="#9A3412"];
        n7 [label="Null Model Comparison", fillcolor="#FED7AA", fontcolor="#9A3412"];
        n8 [label="Multiple Testing Correction", fillcolor="#FED7AA", fontcolor="#9A3412"];
    }

    subgraph cluster_integration {
        label="4. Feature Integration";
        color="#8B5CF6";
        style=filled;
        fillcolor="#F5F3FF";
        labelfontname="Arial Bold";
        labelfontsize=12;
        labelfontcolor="#8B5CF6";
        n9 [label="Ranked Feature Lists\n(Effect Sizes & CIs)", fillcolor="#DDD6FE", fontcolor="#5B21B6"];
        n10 [label="Sample-Feature Networks", fillcolor="#DDD6FE", fontcolor="#5B21B6"];
        n11 [label="Feature Interaction Graphs", fillcolor="#DDD6FE", fontcolor="#5B21B6"];
    }

    subgraph cluster_output {
        label="5. Output Generation";
        color="#6B7280";
        style=filled;
        fillcolor="#F3F4F6";
        labelfontname="Arial Bold";
        labelfontsize=12;
        labelfontcolor="#6B7280";
        n12 [label="Text Report\n(Summary & Insights)", fillcolor="#D1D5DB", fontcolor="#1F2937"];
        n13 [label="JSON / XML\n(Structured Data)", fillcolor="#D1D5DB", fontcolor="#1F2937"];
        n14 [label="GNN/Transformer-Ready\nMatrices", fillcolor="#D1D5DB", fontcolor="#1F2937"];
    }

    // Enhanced Flow with Styled Edges and Arrows
    n1 -> n4 [label="Data Input", color="#3B82F6", arrowhead=normal, style=dashed];
    n2 -> n4 [label="Metadata Integration", color="#3B82F6", arrowhead=normal];
    n3 -> n4 [label="Optional Markers", color="#3B82F6", arrowhead=normal, style=dotted];
    n4 -> n5 [label="Tree Structure Output", color="#22C55E", arrowhead=normal];
    n5 -> n6 [label="Detected Interactions", color="#22C55E", arrowhead=normal];
    n6 -> n7 [label="Resampled Datasets", color="#F59E0B", arrowhead=normal];
    n7 -> n8 [label="Null Model Results", color="#F59E0B", arrowhead=normal];
    n8 -> n9 [label="Validated Features", color="#8B5CF6", arrowhead=normal];
    n8 -> n10 [label="Network Structures", color="#8B5CF6", arrowhead=normal];
    n8 -> n11 [label="Interaction Graphs", color="#8B5CF6", arrowhead=normal];
    n9 -> n12 [label="Feature Summaries", color="#6B7280", arrowhead=normal];
    n10 -> n12 [label="Network Visualizations", color="#6B7280", arrowhead=normal];
    n11 -> n12 [label="Graph Insights", color="#6B7280", arrowhead=normal];
    n9 -> n13 [label="Structured Features", color="#6B7280", arrowhead=normal];
    n10 -> n13 [label="Network Data Export", color="#6B7280", arrowhead=normal];
    n11 -> n13 [label="Graph Export", color="#6B7280", arrowhead=normal];
    n9 -> n14 [label="Feature Matrices", color="#6B7280", arrowhead=normal];
    n10 -> n14 [label="Network Matrices", color="#6B7280", arrowhead=normal];
    n11 -> n14 [label="Graph Matrices", color="#6B7280", arrowhead=normal];
}